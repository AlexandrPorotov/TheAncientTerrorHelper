<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.10.xsd">

    <!--Add key Detectives with Abilities -->
    <changeSet id="v2:1" author="Dale">
        <addColumn tableName="detective">
            <column name="abilities_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="detective"
                                 baseColumnNames="abilities_id"
                                 constraintName="fk_detective_abilities"
                                 referencedTableName="abilities"
                                 referencedColumnNames="id"/>
    </changeSet>

    <!--Add key Locations with Evidences -->
    <changeSet id="v2:2" author="Dale">
        <addColumn tableName="evidence">
            <column name="location_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="evidence"
                                 baseColumnNames="location_id"
                                 constraintName="fk_evidence_location"
                                 referencedTableName="location"
                                 referencedColumnNames="id"/>
    </changeSet>

    <!--Add key Detective with Location-->
    <changeSet id="v2:3" author="Dale">
        <addColumn tableName="detective">
            <column name="location_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="detective"
                                 baseColumnNames="location_id"
                                 constraintName="fk_detective_location"
                                 referencedTableName="location"
                                 referencedColumnNames="id"/>
    </changeSet>

    <!--Add key Detective with Location (current location)
    <changeSet id="v2:4" author="Dale">
        <addColumn tableName="detectives">
            <column name="current_location_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="detectives"
                                 baseColumnNames="current_location_id"
                                 constraintName="fk_detective_current_location"
                                 referencedTableName="locations"
                                 referencedColumnNames="id"/>
    </changeSet>
    -->

    <!--Add key Artifact with Detective-->
    <changeSet id="v2:5" author="Dale">
        <addColumn tableName="artifact">
            <column name="detective_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="artifact"
                                 baseColumnNames="detective_id"
                                 constraintName="fk_artifact_detective"
                                 referencedTableName="detective"
                                 referencedColumnNames="id"/>
    </changeSet>

    <!--Add key Active with Detective-->
    <changeSet id="v2:6" author="Dale">
        <addColumn tableName="active">
            <column name="detective_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="active"
                                 baseColumnNames="detective_id"
                                 constraintName="fk_active_detective"
                                 referencedTableName="detective"
                                 referencedColumnNames="id"/>
    </changeSet>

    <!-- Add key Path with Location-->
    <changeSet id="v2:7" author="Dale">
        <addColumn tableName="path">
            <column name="start_location_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="path"
                                 baseColumnNames="start_location_id"
                                 constraintName="fk_path_start_location"
                                 referencedTableName="location"
                                 referencedColumnNames="id"/>
        <addColumn tableName="path">
            <column name="end_location_id" type="UUID">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableName="path"
                                 baseColumnNames="end_location_id"
                                 constraintName="fk_path_end_location"
                                 referencedTableName="location"
                                 referencedColumnNames="id"/>
    </changeSet>

</databaseChangeLog>